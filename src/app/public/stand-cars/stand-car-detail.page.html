<app-public-header [title]="title()" [showBack]="true"></app-public-header>

<ion-content [fullscreen]="true" color="light">
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  @if (loading) {
    <div class="skeleton">
      <ion-skeleton-text animated style="width:100%; height:220px"></ion-skeleton-text>
      <ion-skeleton-text animated style="width:60%; height:18px; margin-top:12px"></ion-skeleton-text>
      <ion-skeleton-text animated style="width:90%; height:12px; margin-top:6px"></ion-skeleton-text>
    </div>
  }

  @if (error && !loading) {
    <div class="error-block">
      <p>{{ error }}</p>
      <ion-button fill="outline" size="small" (click)="load(true)">Tentar novamente</ion-button>
      <ion-button size="small" fill="clear" (click)="backToList()">Voltar</ion-button>
    </div>
  }

  @if (car && !loading) {
    <div class="gallery-scroll">
      @for (img of images; track img) {
        <div class="image" [style.background-image]="'url(' + img + ')' "></div>
      }
    </div>
    <div class="details">
      <div class="title-row">
        <h1>{{ title() }}</h1>
        @if (car.status) {
          <ion-chip color="dark">
            <ion-label>{{ display(car.status) }}</ion-label>
          </ion-chip>
        }
      </div>
      <p class="meta">{{ meta() || 'Agende a visita ao stand para saber mais.' }}</p>
      <p class="description">{{ car.description || 'Descricao nao disponivel.' }}</p>
      <ion-list>
        @if (car.fuel) {
          <ion-item>
            <ion-icon name="flash-outline" slot="start"></ion-icon>
            <ion-label>Combustivel</ion-label>
            <ion-label slot="end">{{ display(car.fuel) }}</ion-label>
          </ion-item>
        }
        @if (car.month) {
          <ion-item>
            <ion-icon name="calendar-outline" slot="start"></ion-icon>
            <ion-label>Mes</ion-label>
            <ion-label slot="end">{{ display(car.month) }}</ion-label>
          </ion-item>
        }
        @if (car.origin) {
          <ion-item>
            <ion-icon name="earth-outline" slot="start"></ion-icon>
            <ion-label>Origem</ion-label>
            <ion-label slot="end">{{ display(car.origin) }}</ion-label>
          </ion-item>
        }
        @if (car.brand || car.car_model) {
          <ion-item>
            <ion-icon name="car-outline" slot="start"></ion-icon>
            <ion-label>Modelo</ion-label>
            <ion-label slot="end">{{ display(car.brand) }} {{ display(car.car_model) }}</ion-label>
          </ion-item>
        }
      </ion-list>
      <ion-button expand="block" color="dark" (click)="backToList()">
        Voltar ao stand
      </ion-button>
    </div>
  }
</ion-content>
